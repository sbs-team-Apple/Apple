<!DOCTYPE html>
<html layout:decorate="~{common/layout}" lang="en">
<head>
    <!-- 필요한 스타일시트, 스크립트 등을 포함합니다. -->
    <style>
        .Transactions_list {
            margin-bottom: 10px;
            border: 1px solid #000;
            padding: 10px;
        }
        .tab-button {
            cursor: pointer;
        }

        .button-container {

        text-align: center;
        padding: 10px;
        }
        .spacer {
        margin: 0 40px;
        }

        .title {
        font-size: 20px;
        border-bottom: 2px solid #000;
        margin-bottom: 10px;

        }


    </style>
</head>
<body>

<div layout:fragment="content" class="container m-auto flex justify-center flex-col items-center -mt-16 min-h-screen">
    <div class="mt-16">
        <div style="height: 50px;"></div>
        <div class="container_2 my-3 text-center">
            <p class="badge badge-secondary badge-outline" style="display: inline-block; margin-right: 10px;">보유한 <i class="fa-solid fa-heart" style="color: #ff0000;"></i> : <span th:text="${userCyberMoney}"></span>개</p>
            <p class="badge badge-secondary badge-outline" style="display: inline-block; margin-right: 10px;">받은 <i class="fa-solid fa-heart" style="color: #ff0000;"></i> : <span th:text="${receivedCyberMoney}"></span>개</p>
        </div>




        <div class="tab-buttons" style="display: flex; justify-content: center;">
            <div style="text-align: center; flex: 1;">
                <button type="submit" class="btn mr-1"
                        style="border-radius:10px; border :1px solid #f08dac; background-color :#f08dac" onclick="showTab('receivedTab')">누군가 하트를 보냈어요!</button>
            </div>
            <div style="text-align: center; flex: 1;">
                <button type="submit" class="btn ml-1"
                        style="border-radius:10px; border :1px solid #f08dac; background-color :#f08dac" onclick="showTab('completedTab')">승인이 완료된 하트에요!</button>
            </div>
        </div>
        <div class="title" style="height: 20px;"></div>



        <div id="receivedTab" class="tab-content">
            <ul>
                <li class="Transactions_list" th:each="transaction : ${receivedTransactions}" style="display: flex; justify-content: space-between;">
                    <div>
                        <p th:text="${transaction.senderUser.username} +' 님이 ♥ ' + ${transaction.amount} + '개를 보냈습니다'"></p>
                        <p th:text="${transaction.transactionDate}"></p>
                    </div>
                    <!-- "수락" 버튼 -->
                    <div style="display: flex; align-items: center;">
                        <form th:action="@{/user/processTransaction}" method="post">
                            <input type="hidden" name="transactionId" th:value="${transaction.id}" />
                            <input type="hidden" name="action" value="accept" /> <!-- 수락 작업 설정 -->
                            <button class="btn-sm btn btn-outline btn-info" type="submit"
                                    th:disabled="${transaction.isAccepted() or transaction.isRejected()}">수락</button>
                        </form>
                        <div style="width: 10px;"></div> <!-- 10px 여백 추가 -->
                        <!-- "거절" 버튼 -->
                        <form th:action="@{/user/processTransaction}" method="post">
                            <input type="hidden" name="transactionId" th:value="${transaction.id}" />
                            <input type="hidden" name="action" value="reject" /> <!-- 거절 작업 설정 -->
                            <button class="btn-sm btn btn-outline btn-info" type="submit"
                                    th:disabled="${transaction.isAccepted() or transaction.isRejected()}">거절</button>
                        </form>
                    </div>
                </li>
            </ul>
        </div>


        <div id="completedTab" class="tab-content " style="display: none;">
            <ul>
                <li class="Transactions_list" th:each="transaction : ${completedTransactions}" th:if="${transaction.isAccepted()} or ${transaction.isRejected()}" style="display: flex; justify-content: space-between;"
                    th:unless="${transaction.senderUser.username eq user.username}" th:remove="tag">
                    <div>
                        <p th:text="${transaction.senderUser.username} +' 님이 ♥ ' + ${transaction.amount} + '개를 보냈습니다'"></p>
                        <p th:text="${transaction.transactionDate}"></p>
                    </div>
                    <div> 승인 완료</div>
                </li>
            </ul>
        </div>






    </div>
    <div class="flex-grow"></div>
    <div class="button-container">
        <button type="submit" class="btn btn-sm"
                style="border-radius:10px; border :1px solid #3B84F7; background-color :#ffffff"><a href="/user/payment"><i class="fa-solid fa-won-sign"></i> 결제하기</a></button>
        <span class="spacer">|</span>
        <button type="submit" class="btn btn-sm"
                style="border-radius:10px; border :1px solid #3B84F7; background-color :#ffffff"><a href="/exchange/create"><i class="fa-solid fa-sack-dollar"></i> 환전하기</a></button>
    </div>
    <div style="height: 20px;"></div>
    <div class="outer-box" >
        <form action="/user/updateMinHeart" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <div class="title text-lg border-b border-black">최소 하트값 설정<p style="display: inline-block; margin-right: 10px;">&nbsp(최소 하트: <span th:text="${minHeart}+'개)'"></span></p>
            </div>
            <label for="minHeartInput">최소 하트값:</label>
            <input class="input input-sm input-secondary  max-w-xs" type="number" name="minHeart" id="minHeartInput" placeholder="최소 하트값 입력" />
            <button type="submit" class="btn btn-sm"
                    style="border-radius:10px; border :1px solid #f08dac; background-color :#F7A03B">확인</button>
        </form>
    </div>

    <!--    <div class="outer-box">-->
    <!--        <div class="inner-box">-->
    <!--            <p class="title">마음에 드는 이성과 대화 해보세요!</p>-->
    <!--            <p>"수락"을 누르면 하트를 받고, 해당 이성과의 채팅방이 열립니다.</p>-->
    <!--            <p>※ 욕설 및 음담패설을 하지 않도록 합니다.</p>-->
    <!--            <p>※ 억지로 상대방의 정보를 캐내려고 하지 마세요.</p>-->
    <!--            <p>"거절"을 누르면 하트를 받지 않고, 해당 이성에게 하트를 반송합니다.</p>-->
    <!--            <p>- 거절해도 상대방에게 알림이 가지 않아요.</p>-->
    <!--        </div>-->
    <!--    </div>-->

    <script>
        function showTab(tabName) {
            var tabContents = document.getElementsByClassName('tab-content');
            for (var i = 0; i < tabContents.length; i++) {
                tabContents[i].style.display = 'none';
            }
            document.getElementById(tabName).style.display = 'block';
        }
    </script>
</div>
</body>
</html>